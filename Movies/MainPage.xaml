<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Movies.MainPage"
             x:Name="MainMainPage"
             xmlns:local="clr-namespace:Movies.Controls"
             xmlns:binding="clr-namespace:Movies.ViewModels"
             BackgroundColor="DarkGray"
             >
    <ContentPage.BindingContext>
        <binding:MoviesViewModel />
    </ContentPage.BindingContext>

    <ScrollView>
        <StackLayout>
            <Label Text="Adjust Size" Margin="30, 20, 0, 0"/>
            <Slider Minimum="0" Maximum="40" Value="{Binding ElementWidth, Mode=TwoWay}" Margin="20, 20, 20, 0"/>
            <Label Text="Adjust Color" Margin="30, 20, 0, 0"/>
            <StackLayout Orientation="Horizontal" Spacing="10" Margin="30, 20, 20, 0">
                <Button BackgroundColor="Red" WidthRequest="70" HeightRequest="30" Padding="0" Text="Red" TextColor="White" Command="{Binding RedCommand}"/>
                <Button BackgroundColor="Blue" WidthRequest="70" HeightRequest="30" Padding="0" Text="Blue" TextColor="White" Command="{Binding BlueCommand}"/>
                <Button BackgroundColor="Yellow" WidthRequest="70" HeightRequest="30" Padding="0" Text="Yellow" TextColor="Black" Command="{Binding YellowCommand}"/>
            </StackLayout>
            <Label Text="Adjust number of elements" Margin="30, 20, 0, 0"/>
            <Slider x:Name="MySlider" Minimum="0" Maximum="7" Value="{Binding TotalStars, Mode=TwoWay}" ValueChanged="OnSliderValueChanged" Margin="20, 20, 20, 0"/>
            <Label Text="Select Shape" Margin="30, 20, 0, 0"/>
            <StackLayout Orientation="Horizontal" Spacing="10" Margin="30, 20, 20, 0">
                <ImageButton x:Name="circleButton" BackgroundColor="White" CornerRadius="10" WidthRequest="70" HeightRequest="30" Padding="0" Source="{Binding ImageSourceCircle}" Command="{Binding CircleShapeCommand}"/>
                <ImageButton x:Name="squareButton" BackgroundColor="White" CornerRadius="10" WidthRequest="70" HeightRequest="30" Padding="0" Source="{Binding ImageSourceSquare}" Command="{Binding SquareShapeCommand}"/>
                <ImageButton x:Name="starButton" BackgroundColor="White" CornerRadius="10" WidthRequest="70" HeightRequest="30" Padding="0" Source="{Binding ImageSourceStar}" Command="{Binding StarShapeCommamnd}"/>
            </StackLayout>
            <CollectionView ItemsSource="{Binding Movies}" WidthRequest="{Binding ImageWidth}" Margin="0, 20, 0, 0">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Vertical"
                           ItemSpacing="20" />
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame BorderColor="Gray" Margin="40, 0, 40, 0" WidthRequest="{Binding ImageWidth}" BackgroundColor="Gray" HasShadow="True" CornerRadius="10">
                            <Grid BackgroundColor="LightGray"  WidthRequest="{Binding ImageWidth}">
                                <Image Source="{Binding Image}" HeightRequest="{Binding BindingContext.ImageHeight, Source={x:Reference MainMainPage}}" WidthRequest="{Binding ImageWidth}" Aspect="AspectFill"/>
                                <local:RatingView 
                        Value="{Binding Rating}" 
                        Color="{Binding Color}"
                        TotalStars="{Binding BindingContext.TotalStars, Source={x:Reference MainMainPage}}"
                        ElementWidth="{Binding BindingContext.ElementWidth, Source={x:Reference MainMainPage}}"
                        Shape="{Binding BindingContext.Shape, Source={x:Reference MainMainPage}}"
                        VerticalOptions="End" 
                        HorizontalOptions="FillAndExpand" 
                        HeightRequest="50" 
                        BackgroundColor="LightGray"/>
                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </StackLayout>
    </ScrollView>

</ContentPage>
